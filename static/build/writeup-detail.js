// Generated by CoffeeScript 1.10.0
(function() {
  $(function() {
    var editor, toolbar;
    $('a[href$="writeup/"]').addClass('current');
    $('#writeupHolder').html($('#writeupHolder').text());
    toolbar = ['title', 'bold', 'italic', 'strikethrough', '|', 'ol', 'ul', 'blockquote', 'code', 'table', '|', 'link', 'hr', '|', 'markdown'];
    Simditor.locale = 'en-US';
    editor = new Simditor({
      textarea: $('#editor'),
      toolbar: toolbar,
      toolbarFloat: false
    });
    $('p.marked').each(function() {
      return $(this).html($(this).text());
    });
    $('#submitBtn').on('click', function() {
      if (editor.getValue()) {
        return $.ajax({
          url: '/writeup/comment/',
          type: 'post',
          dataType: 'json',
          data: {
            content: editor.getValue(),
            writeup: 2,
            reply: 0
          },
          success: function(data) {
            if (data.msg === 'okay') {
              return location.href = '';
            }
          }
        });
      }
    });
    $('button.reply').on('click', function() {
      var $this;
      try {
        editor2.destroy();
      } catch (undefined) {}
      $this = $(this).hide().siblings('button').show();
      $this.parent().append('<textarea style="display: none;"></textarea>');
      return window.editor2 = new Simditor({
        textarea: $this.siblings('textarea'),
        toolbar: toolbar
      });
    });
    $('button.cancel').on('click', function() {
      editor2.destroy();
      $(this).hide().siblings('button').hide();
      return $(this).siblings('button.reply').show();
    });
    $('button.submit').on('click', function() {
      var pk;
      pk = $(this).data('focus');
      if (editor2.getValue()) {
        return $.ajax({
          url: '/writeup/comment/',
          type: 'post',
          dataType: 'json',
          data: {
            content: editor2.getValue(),
            writeup: 2,
            reply: pk
          },
          success: function(data) {
            if (data.msg === 'okay') {
              return location.href = '';
            }
          }
        });
      }
    });
    return stickFooter();
  });

}).call(this);
