// Generated by CoffeeScript 1.10.0
(function() {
  $(function() {
    var csrfSafeMethod, csrftoken;
    csrftoken = $.cookie('csrftoken');
    csrfSafeMethod = function(method) {
      return /^(GET|HEAD|OPTIONS|TRACE)$/.test(method);
    };
    $.ajaxSetup({
      beforeSend: function(xhr, settings) {
        if (!(csrfSafeMethod(settings.type) || this.crossDomain)) {
          return xhr.setRequestHeader('X-CSRFToken', csrftoken);
        }
      }
    });
    $('#username').focus();
    $('.alert').on('click', function() {
      return $(this).fadeOut();
    });
    $('#signIn').on('click', function() {
      var salt;
      if ($('#username').val() && $('#password').val()) {
        salt = $('#signIn').data('salt');
        return $.ajax({
          url: 'person/sign-in/',
          type: 'post',
          dataType: 'json',
          data: {
            username: $('#username').val(),
            password: $.sha256($.sha256($('#password').val()) + salt),
            salt: salt
          },
          success: function(data) {
            if (data.msg === 'okay') {
              $('#signInDone').fadeIn();
              return window.setTimeout('location.href="/person"', 500);
            } else if (data.msg === 'fail') {
              return $('#signInFail').fadeIn();
            } else if (data.msg === 'email') {
              return $('#emailFail').fadeIn();
            } else {
              return $('#alertError').fadeIn();
            }
          }
        });
      }
    });
    return $('#signUp').on('click', function() {
      if ($('#remail').val() && $('#rusername').val() && $('#rpassword').val()) {
        return $.ajax({
          url: 'person/sign-up/',
          type: 'post',
          dataType: 'json',
          data: {
            username: $('#rusername').val(),
            password: $.sha256($('#rpassword').val()),
            email: $('#remail').val()
          },
          success: function(data) {
            if (data.msg === 'okay') {
              return $('#signUpDone').fadeIn();
            } else if (data.msg === 'fail') {
              return $('#signUpFail').fadeIn();
            } else {
              return $('#alertError').fadeIn();
            }
          }
        });
      }
    });
  });

}).call(this);
